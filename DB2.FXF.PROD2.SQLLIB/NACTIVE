SELECT CHAR(STRIP(GETVARIABLE('SYSIBM.SSID')),4) AS SSID,'TS' AS "TYPE",
       STRIP(DBNAME) AS DBNAME,STRIP(NAME) AS NAME,
       NACTIVE,BPOOL,INT(LOG10(NACTIVE)) AS CLUSTER
  FROM SYSIBM.SYSTABLESPACE
  WHERE NACTIVE > 0
UNION ALL
SELECT CHAR(STRIP(GETVARIABLE('SYSIBM.SSID')),4) AS SSID,'IX' AS "TYPE",
       STRIP(I.DBNAME) AS DBNAME,STRIP(I.INDEXSPACE) AS INDEXSPACE,
       S.NACTIVE,I.BPOOL,INT(LOG10(S.NACTIVE)) AS CLUSTER
  FROM SYSIBM.SYSINDEXES I,
       SYSIBM.SYSINDEXSPACESTATS S
  WHERE S.NACTIVE > 0
    AND S.CREATOR = I.CREATOR
    AND S.NAME = I.NAME
 ORDER BY 3,4,2 DESC
;
SELECT ORDEM, SUM(NACTIVE) FROM (
SELECT CHAR(STRIP(GETVARIABLE('SYSIBM.SSID')),4) AS SSID
      ,STRIP(DBNAME)||'.'||STRIP(NAME),NACTIVE,BPOOL
      ,INT(LOG10(NACTIVE)) AS ORDEM
  FROM SYSIBM.SYSTABLESPACE
  WHERE NACTIVE > 0 ) AS A
  GROUP BY ORDEM
;
SELECT ORDEM, COUNT(OBJ) FROM (
SELECT CHAR(STRIP(GETVARIABLE('SYSIBM.SSID')),4) AS SSID
      ,STRIP(DBNAME)||'.'||STRIP(NAME) AS OBJ, NACTIVE,BPOOL
      ,INT(LOG10(NACTIVE)) AS ORDEM
  FROM SYSIBM.SYSTABLESPACE
  WHERE NACTIVE > 0 ) AS A
  GROUP BY ORDEM
;
SELECT BPOOL, COUNT(OBJ) AS "#OBJ" ,SUM(NACTIVE) AS NACTIVE FROM (
SELECT CHAR(STRIP(GETVARIABLE('SYSIBM.SSID')),4) AS SSID
      ,STRIP(DBNAME)||'.'||STRIP(NAME) AS OBJ, NACTIVE,BPOOL
      ,INT(LOG10(NACTIVE)) AS ORDEM
  FROM SYSIBM.SYSTABLESPACE
  WHERE NACTIVE > 0 ) AS A
  GROUP BY BPOOL
;
