-- EXPLAIN FOR INC05798701
--
SET CURRENT SQLID='PRODDBA';
DELETE  FROM PRODDBA.DSN_STATEMNT_TABLE
 WHERE QUERYNO=5270036;

EXPLAIN ALL SET QUERYNO=5270036 FOR
SELECT DISTINCT PLAT.DRIVER_NUMBER, PLAT.TERMINAL_ID, PLAT.UNIT_NUMBER,
     PLAT.STOP_NUMBER, PLAT.PRO_NUMBER, PLAT.SUFFIX_NUMBER,
  PLAT.SHIPPER_CODE,
     PLAT.SHIPPER_NAME, PLAT.CONS_CODE, PLAT.CONS_NAME,
  PLAT.CONS_ADDR1_TEXT,
     PLAT.CONS_ADDR2_TEXT, PLAT.CONS_CITY, PLAT.CONS_STATE,
  PLAT.CONS_ZIP_CODE,
     PLAT.TOTAL_PIECES_QTY, PLAT.TOTAL_WEIGHT_QTY,
  PLAT.HANDLING_UNIT_CNT,
     PLAT.COLLECTION_AMT1, PLAT.COLLECTION_CODE1, PLAT.COLLECTION_AMT2,
     PLAT.COLLECTION_CODE2, PLAT.STOP_TYPE_CD, PLAT.AREA_CODE_NBR,
     PLAT.PHONE_NBR_TXT, PLAT.MESSAGE_ACTION_CD,
  SHIP.CONS_COUNTRY_CODE,
     SHLO.PRTY_SEQ_NBR, CALN.RECEIVING_OPEN_TM,
  CALN.RECEIVING_CLOSE_TM,
     CALN.BUSINESS_OPEN_TM, CALN.BUSINESS_CLOSE_TM,
  APPT.APPOINT_FROM_TM,
     APPT.FK_APPOINTMENT_TM, SABS.GUARANTEED_DATE, SABS.GUARANTEED_TIME
FROM PROD.DELIVERY_TO_PLATO PLAT
INNER JOIN PROD.SHIPMENT SHIP
ON (SHIP.PRO_NUMBER = PLAT.PRO_NUMBER AND SHIP.SUFFIX_NUMBER =
         PLAT.SUFFIX_NUMBER)
LEFT OUTER JOIN PROD.SHIPMENT_LOCATION SHLO
ON (SHLO.FK_PRO_NUMBER = SHIP.PRO_NUMBER AND SHLO.FK_SUFFIX_NUMBER =
         SHIP.SUFFIX_NUMBER)
LEFT OUTER JOIN PROD.AF_CALENDAR CALD
ON (CALD.GREG_DT = CURRENT DATE)
LEFT OUTER JOIN PROD.CUST_WKLY_CALENDAR CALN
ON (CALN.FK_CUSTOMER_NUMBER = SHIP.CONS_CODE AND CALN.TERMINAL_ID =
         SHIP.DEST_TERMINAL_ID AND CALN.OPEN_CLOSED_CODE = 'O' AND
         CALN.DAY_OF_WEEK_CODE = SUBSTR(CALD.WEEKDAYNM, 1, 3))
LEFT OUTER JOIN PROD.APPT_SHIPMENT APPT
ON (APPT.FK_PRO_NUMBER = PLAT.PRO_NUMBER AND APPT.FK_SUFFIX_NUMBER =
         PLAT.SUFFIX_NUMBER)
LEFT OUTER JOIN PROD.SHP_ABSOLUTE SABS
ON (SABS.PRO_NUMBER = PLAT.PRO_NUMBER AND SABS.SERVICE_TYPE_FLAG = 'G')
WHERE PLAT.TERMINAL_ID = ? AND PLAT.DRIVER_NUMBER = ?
WITH UR;

SELECT * FROM PRODDBA.PLAN_TABLE
 WHERE QUERYNO=5270036
 ORDER BY QUERYNO,QBLOCKNO,PLANNO;
SELECT * FROM PRODDBA.DSN_STATEMNT_TABLE
 WHERE QUERYNO=5270036;
DELETE  FROM PRODDBA.PLAN_TABLE
 WHERE QUERYNO=5270036;
DELETE  FROM PRODDBA.DSN_STATEMNT_TABLE
 WHERE QUERYNO=5270036;
COMMIT;
