SELECT DISTINCT DBNAME_NM, JOB_NM, COUNT(*)
  FROM TEST.IC_CONTROL
 GROUP BY DBNAME_NM, JOB_NM
WITH UR;
SELECT DISTINCT JOB_NM
     , 'D'
FROM TEST.IC_CONTROL
UNION
SELECT DISTINCT WEEKLY_JOB_NM
     , 'W'
FROM TEST.IC_CONTROL
WHERE WEEKLY_JOB_NM IS NOT NULL
  AND WEEKLY_JOB_NM <> ' '
ORDER BY 1 DESC
WITH UR
;
SELECT *
  FROM TEST.IC_CONTROL
-- WHERE JOB_NM <> 'OBSOLETE'
-- WHERE DBNAME_NM = 'ICUCSTP'
-- AND TSNAME_NM = 'TCUCN'
WITH UR;

SELECT DBNAME_NM , TSNAME_NM
FROM TEST.IC_CONTROL
WHERE((JOB_NM <> 'OBSOLETE' AND  'D' = 'D')
   OR (WEEKLY_JOB_NM <> 'OBSOLETE' AND  'W' = 'D'
       AND  WEEKLY_JOB_NM IS NOT NULL
       AND  WEEKLY_JOB_NM <> ' '))
  AND (OBJ_TYPE = 'TS'
       AND (DBNAME_NM LIKE 'UCUCSTP%'
            AND (TSNAME_NM LIKE 'TCUCN%' OR  TSNAME_NM = '*')))
ORDER BY DBNAME_NM, TSNAME_NM
WITH UR;
