SELECT * FROM SYSIBM.SYSCOPY
WHERE DBNAME='TFMSV15P' AND TSNAME='TFMTS061'
  AND ICTYPE = 'W'
;
SELECT DISTINCT T.DBNAME,T.NAME
  FROM SYSIBM.SYSTABLESPACE T
 WHERE NOT EXISTS ( SELECT '1' FROM
                       SYSIBM.SYSCOPY       C
                    WHERE T.DBNAME = C.DBNAME
                      AND T.NAME   = C.TSNAME
                      AND C.ICTYPE = 'W'
                      AND C.ICDATE >= '180501' )
;
    SELECT DISTINCT RTS.DBNAME        --  /* NOT REORGED LAST 90 DAYS */
        , RTS.NAME
 --     , RTS.PARTITION
 --     , COALESCE(DECIMAL(RTS.TOTALROWS),0)
 --     , COALESCE(RTS.NACTIVE,0)
 --     , COALESCE(RTS.SPACE,0)
 --     , COALESCE(RTS.REORGLASTTIME,'0001-01-01-00.00.00.000000')
 --     , COALESCE(RTS.REORGINSERTS,0)
 --     , COALESCE(RTS.REORGDELETES,0)
 --     , COALESCE(RTS.REORGUPDATES,0)
 ---    , COALESCE(RTS.REORGUNCLUSTINS,0)
 ---    , COALESCE(RTS.REORGMASSDELETE,0)
 ---    , COALESCE(RTS.REORGNEARINDREF,0)
 ---    , COALESCE(RTS.REORGFARINDREF,0)
 --     , TSP.BPOOL
    FROM SYSIBM.SYSTABLESPACESTATS RTS ,
        SYSIBM.SYSTABLESPACE TSP
    WHERE TSP.DBNAME = RTS.DBNAME
      AND TSP.NAME = RTS.NAME
      AND TSP.TYPE <> 'O'               -- /* NO LOB OBJECTS */
      AND EXISTS (SELECT 'TRUE'
                    FROM SYSIBM.SYSDATABASE DB
                   WHERE DB.NAME = RTS.DBNAME)
         --          AND DB.STGROUP = 'OAMSG')
      AND RTS.PARTITION >= 0
--    AND DECIMAL(RTS.REORGINSERTS)
--      + DECIMAL(RTS.REORGDELETES)
--      + DECIMAL(RTS.REORGUPDATES) > 0
--    AND(RTS.LOADRLASTTIME <= CURRENT TIMESTAMP -  30 DAYS
      AND RTS.REORGLASTTIME <  CURRENT TIMESTAMP -  90 DAYS
