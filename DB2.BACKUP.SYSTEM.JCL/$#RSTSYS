RECOVER TO SYSTEM POINT IN TIME USING BACKUP SYSTEM                     00010000===================================================                     00020000Preparation                                                             000210001) Identify the DB2 Backup System available to recover in POINT IN TIME 00030000List BSDS (DSNJU004)                                                    00040000Find 'BACKUP SYSTEM UTILITY HISTORYØ                                    00050000Obtain the LRSN value (for conditional restart )                        00060000on specific date/time (PIT) => will be used on step 2 execution         00070000                                                                        00071000                                                                        000800002) Engage Storage team to monitor HSM background tasks                  00090000                                                                        00100000Execution                                                               001100001) Stop DB2F/DB3F                                                       00120008   Use $stopxx commands from SSXDP.ssid.TAILOR.SDSNSAMP                 00130005                                                                        001310002) Create conditional restart                                           00140000   SYSPITR is log-truncation point.                                     00150000   This value was previous collected on preparation                     00160000   example: CRESTART CREATE,SYSPITR=????????????                        00170000   DB2FJU03                                                             00200008   DB3FJU03                                                             00210008   Note:  Time is GMT on CRESTART output                                00240001                                                                        002410073) List BSDS - DSNJU004                                                 00250001   Check ou the active CRC record                                       00260001   on section : **** ACTIVE CRCR RECORD ****                            00270001                                                                        002800014) Deallocate command on catalog                                        00290009   RO *ALL,F CATALOG,UNALLOCATE(CATALOG.MVSICF1.DB2F)                   00300009                                                                        00310009   IEE421I RO *ALL,F CATALOG,UNALLO 089                                 00311009   SYSNAME  RESPONSES ------------------------------------------------  00312009   MVSx     IEC351I CATALOG ADDRESS SPACE MODIFY COMMAND ACTIVE         00313009            IEC352I CATALOG ADDRESS SPACE MODIFY COMMAND COMPLETED      00314009   MVSx     IEC351I CATALOG ADDRESS SPACE MODIFY COMMAND ACTIVE         00315009            IEC352I CATALOG ADDRESS SPACE MODIFY COMMAND COMPLETED      00316009   MVSx     IEC351I CATALOG ADDRESS SPACE MODIFY COMMAND ACTIVE         00317009            IEC352I CATALOG ADDRESS SPACE MODIFY COMMAND COMPLETED      00318009                     :                                                  00319009   (In case of issue contact Storage team)                              00319109                                                                        003192095) Remove Incremental FC relationship FCWITHDR command                  00319309  5.1) SSXSP.SHR.JCL.LIB(FCWBDDB2F)                                     00319409  5.2) SSXSP.FCQUERY.DB2F.OUTPUT.WITHDRAW                               00319509 (Storage team creates a rexx to execute this command on all dasds)     00319609                                                                        003200016) Deallocate  LOCK and  SCA  strucure of coupling facility             00331009   $SETXCF                                                              00340002                                                                        003500027) Start DB2. When the DB2 restart processing for the conditional       00360009   restart with the SYSPITR option completes,                           00370002   DB2 enters system RECOVER-pending and access maintenance mode.       00380002   During system RECOVER-pending mode, you can run only                 00390002   the RESTORE SYSTEM utility.                                          00400002   Reply Y to message below:                                            00401002   *32 DSNJ245I  -ssid CONDITIONAL RESTART RECORD                       00402002   INDICATES TRUNCATION AT LRSN CF658A552FA4.                           00403002   REPLY Y TO CONTINUE, N TO CANCEL                                     00404002   /32,Y                                                                00405002   *DSNR050I  -ssid DSNRRPRC DB2 STARTED IN SYSTEM RECOVER              00406002   PENDING MODE DSNR002I  -ssid RESTART COMPLETED                       00407002                                                                        00408002 DB2 has started in System Recover Pending mode in preparation          00409002 for the RESTORE SYSTEM utility. No database update activity is allowed,00409102 and DB2 is in restricted access(mode)                                  00409202                                                                        00409302 Repeat this procedure for all DBFG MEMBERS:                            00409408   7.1 START DB2F in acc(maint)                                         00430009   7.2 START DB2F in acc(maint)                                         00431009       Reply Y to msg                                                   00440002                                                                        00510002 8) RESTORE SYSTEM                                                      00520009    RSTSYS                                                              00530002The following control statement specifies that the RESTORE SYSTEM       00540002utility is to recover a DB2 subsystem                                   00550002or a data sharing group to a previous point in time by                  00560002restoring volume copies and applying any outstanding log changes.       00570002                                                                        00580002Check msgs on SYSLOG                                                    00590002On syslog:                                                              00600002$HASP373 jobxxxxx STARTED - INIT 21   - CLASS S - SYS MVS3              00610002 ARC1801I FAST REPLICATION RECOVERY IS STARTING FOR 229                 00620002 ARC1801I (CONT.) COPY POOL DSN$DB2F$DB, AT XX:XX:XX ON 2015/08/17      00630008 F CATALOG,UNALLOCATE(CATALOG.MVSICF1.DB2F                        )     00640008 IEC351I CATALOG ADDRESS SPACE MODIFY COMMAND ACTIVE                    00650002 ARC1802I FAST REPLICATION RECOVERY HAS COMPLETED FOR 253               00651002 ARC1802I (CONT.) COPY POOL DSN$DB2F$DB, AT ??:??:?? ON AAAA/MM/DD,     00652008 ARC1802I (CONT.) FUNCTION RC=0000, MAXIMUM VOLUME RC=0000              00653002                                                                        00654002 Note: only DSN$DB2F$DB is recovered by restore system command          00660008                                                                        006700049) After recovery completed, stop DB2s and restart in normal mode       00680009                                                                        0069000410)Checkouts                                                            00700009                                                                        0071000911) BACKUP SYSTEM FULL ESTABLISH FCINCREMENTAL                          00720009    BKPSFINC                                                            00730009                                                                        00740009====                                                                    00750009Lessons learned                                                         00760009xx F CATALOG,UNALLOCATE(CATALOG.MVSICF1.DB2F)                           00770009xx $UCATLG => not working                                               00780009 Job is not working. This is truncanting the command                    00790009                                                                        00800009